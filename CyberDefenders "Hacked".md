#### Исходные данные
###### Ссылки на материалы
https://xakep.ru/2021/12/28/cyberdefenders-hacked/
https://cyberdefenders.org/blueteam-ctf-challenges/71
###### Легенда
В вашу задачу входит анализ скомпрометированного веб-сервера на ОС Linux. Выясните, как злоумышленник получил доступ к системе, какие изменения были внесены и какие техники закрепления использовались (например - бэкдоры, сеансы, пользователи и др.). 
Для исследования вам предоставлена побитовая копия системного диска скомпрометированной машины. 
#### Этапы расследования
- Работа с исходными данными
	- определение формата образа
	- монтирование
- Анализ конфиг-файлов системы
- Определение точки входа злоумышленника
- Поиск методов постэксплуатации
#### Используемые утилиты и инструменты
- PLASO
- Timesketch
- R-Linux
- ewf-tools
	- ewfmount
- sleuthkit
- kpartx
- fdisk

#### Прохождение
##### Работа с исходными данными
- Определяем формат образа диска
	- ``file Webserver.E01``
	- _Webserver.E01: EWF/Expert Witness/EnCase image file format_
	- Нужны инструменты для работы с EWF - то есть ``ewf-tools``
- Создаем директорию для монтирования 
	- ``sudo mkdir -p /mnt/img``
- Выполняем монтирование с помощью ``ewf-tools``
	- ``ewfmount Webserver.E01 /mnt/img/``
- Просматриваем созданную директорию и смотрим разделы смонтированного образа
	- ``sudo ls -lh /mnt/img`` 
	![[Pasted image 20221201142747.png]]
	- ``fdisk -l /mnt/img/ewf1``
![[Pasted image 20221201143002.png]]
- Из вывода утилиты мы можем определить следующие факты:
	- сектора на данном диске имеют размер 512 байт
	- на диске присутствует два раздела Linux
		- обычный, судя по размеру - ``/boot``
		- расширенный с LVM
- Во избежание проблем с монтированием выгружаем модуль ядра ``loop`` и загружаем его снова с количеством разделов равным восьми (**проверить**)
	- ``sudo modprobe -r loop``
	- ``sudo modprobe loop max_part=8``
- Создаем дополнительные директории для монтирования выявленных разделов
	- ``sudo mkdir -p /mnt/boot``
	- ``sudo mkdir -p /mnt/lvm``
- Определяем смонтированный EWF-образ как loop-устройство и назначаем ему ``/dev/loop0``
	- ``sudo losetup --find --show /mnt/img/ewf1``
![[Pasted image 20221201164643.png]]
- Определяем группы томов в LVM с помощью ``kpartx``
	- ``sudo kpartx -av /mnt/img/ewf1``
![[Pasted image 20221201164830.png]]
- Монтируем раздел ``boot`` 
	- ``sudo mount -o ro,loop /dev/loop0p1 /mnt/boot``
- Монтируем раздел с LVM
	- ``sudo mount -o ro,noload /dev/VulnOSv2-vg/root /mnt/lvm``

##### Анализ конфигурационных файлов целевой системы
